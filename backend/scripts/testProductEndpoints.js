const axios = require('axios');

const BASE_URL = 'http://localhost:5000/api';

async function testProductEndpoints() {
  console.log('üß™ Testing Product Endpoints\n');

  try {
    // Test 1: Get all products
    console.log('1. Testing GET /api/products');
    const allProductsResponse = await axios.get(`${BASE_URL}/products`);
    console.log('‚úÖ Status:', allProductsResponse.status);
    console.log('‚úÖ Products found:', allProductsResponse.data.products.length);
    console.log('‚úÖ Pagination:', allProductsResponse.data.pagination);
    
    if (allProductsResponse.data.products.length > 0) {
      const firstProduct = allProductsResponse.data.products[0];
      console.log('‚úÖ First product:', firstProduct.name, '-', '$' + firstProduct.price);
      
      // Test 2: Get single product by ID
      console.log('\n2. Testing GET /api/products/:id');
      const singleProductResponse = await axios.get(`${BASE_URL}/products/${firstProduct._id}`);
      console.log('‚úÖ Status:', singleProductResponse.status);
      console.log('‚úÖ Product:', singleProductResponse.data.name);
      
      // Test 3: Get products with filters
      console.log('\n3. Testing GET /api/products with filters');
      const filteredResponse = await axios.get(`${BASE_URL}/products?brand=Nike&limit=5`);
      console.log('‚úÖ Status:', filteredResponse.status);
      console.log('‚úÖ Nike products found:', filteredResponse.data.products.length);
      
      // Test 4: Get featured products
      console.log('\n4. Testing GET /api/products with featured filter');
      const featuredResponse = await axios.get(`${BASE_URL}/products?isFeatured=true`);
      console.log('‚úÖ Status:', featuredResponse.status);
      console.log('‚úÖ Featured products found:', featuredResponse.data.products.length);
      
      // Test 5: Search products
      console.log('\n5. Testing GET /api/products with search');
      const searchResponse = await axios.get(`${BASE_URL}/products?search=Nike`);
      console.log('‚úÖ Status:', searchResponse.status);
      console.log('‚úÖ Search results found:', searchResponse.data.products.length);
      
    } else {
      console.log('‚ùå No products found in response');
    }

  } catch (error) {
    console.error('‚ùå Error testing product endpoints:');
    if (error.response) {
      console.error('Status:', error.response.status);
      console.error('Data:', error.response.data);
    } else {
      console.error('Message:', error.message);
    }
  }
}

testProductEndpoints();
